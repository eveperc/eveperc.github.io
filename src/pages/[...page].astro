---
import type { GetStaticPathsOptions } from "astro";
import Layout from "../layouts/Layout.astro";
import Articles from "../components/Articles.astro";
import { LowContent } from "../components/LowContent";
import { Pagination } from "../components/Pagination";
import {Category} from "../components/Category";
import "../styles/global.scss";

import { newtClient } from "../lib/newt";
import {categoryContent} from "../lib/category";
import type { Article, Page } from "../lib/newt";

export async function getStaticPaths({ paginate }: GetStaticPathsOptions) {
  const postsData = await newtClient.getContents<Article>({
    appUid: "blog",
    modelUid: "article",
    query: {
      select: ["title", "slug", "body", "category", "coverImage", "updatedAt"],
    },
  });
  const postsContents: Article[] = postsData.items;

  return paginate(postsContents, {
    pageSize: 9,
  });
}

interface Props {
  page: Page;
}
const { page } = Astro.props;
const data: Article[] = page.data;
const url = import.meta.env.SITE_URL;
---

<Layout id="top" title="NeoEveLog" description="NeoEveLog">
  <Category url={url} data={categoryContent}/>
  <Articles articles={data} />
  <LowContent>
    <Pagination page={page} />
  </LowContent>
</Layout>
